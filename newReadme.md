# Gemini 协作绘画工具

一个基于Google Gemini 2.0 API的协作绘画应用，允许用户创建绘画并通过文本提示让AI智能增强或添加内容。

## 功能特点

- **交互式画布**：提供直观的绘画体验，支持多种绘画工具
- **智能形状库**：内置多种形状和自定义形状功能
- **丰富的笔触选择**：多种笔刷样式和自定义设置
- **文本提示增强**：通过简单的文字描述让AI增强您的绘画
- **实时图像生成**：使用Google Gemini 2.0 API进行图像生成
- **导出多格式**：支持PNG、JPEG、SVG和PDF格式导出
- **画作保存与分享**：保存多个画作，并支持通过链接分享
- **缩放和全屏模式**：优化您的绘画体验
- **历史记录**：支持撤销操作

## API调用模式

应用支持三种API调用策略，可以在API密钥设置面板中选择：

### 1. Hugging Face优先模式

- **工作流程**：
  1. 首先尝试调用Hugging Face API进行图像生成
  2. 如果Hugging Face API失败（超时、错误等），自动回退到Gemini API
  3. 使用系统配置的API密钥或用户提供的自定义API密钥

- **适用场景**：
  - 稳定性要求高的场景
  - 无需用户配置API密钥
  - 默认推荐模式

### 2. Gemini API模式

- **工作流程**：
  1. 直接调用Google Gemini API进行图像生成
  2. 不会进行任何回退或重试
  3. 必须使用有效的API密钥

- **适用场景**：
  - 需要最新、最高质量输出的场景
  - 用户拥有自己的Gemini API密钥
  - 对API响应速度要求高的场景

- **API密钥要求**：
  - 此模式下必须配置有效的Gemini API密钥
  - 如未配置，系统会显示验证提示

### 3. Gemini优先模式

- **工作流程**：
  1. 首先尝试调用Gemini API进行图像生成
  2. 如果Gemini API失败（配额不足、错误等），自动回退到Hugging Face
  3. 适用性能与质量平衡的场景

- **适用场景**：
  - 追求高质量输出，但仍需保持可靠性
  - 已配置API密钥但希望有备用方案
  - 对API响应质量要求较高

## API密钥配置

系统支持两种API密钥使用方式：

### 系统预设API密钥

- 应用内置一组系统API密钥，在Hugging Face优先模式下自动使用
- 系统会自动监控预设API密钥的状态，确保服务可用性
- 不需要用户进行任何配置

### 用户自定义API密钥

1. **配置方法**：
   - 点击页面右上角的API密钥状态图标
   - 在弹出的设置面板中添加或选择API密钥
   - 输入密钥名称和密钥内容，点击保存

2. **密钥管理功能**：
   - 支持添加多个API密钥并命名
   - 可以切换使用不同的密钥
   - 支持删除已保存的密钥
   - 密钥状态实时显示（有效/无效）

3. **密钥验证**：
   - 系统会自动验证API密钥的有效性
   - 支持检查密钥格式和配额状态
   - 密钥状态会在界面上显示（绿色表示有效，红色表示无效）

## 使用流程

1. 打开应用，默认进入绘画界面
2. 使用绘画工具创建您的初始绘画
3. 在提示框中输入描述，告诉AI您想添加什么
4. 点击"发送"按钮，系统会根据当前API模式处理您的请求
5. AI生成的图像会显示在画布上
6. 您可以继续编辑或保存生成的图像

## 技术栈

- **前端框架**：Next.js
- **图像生成**：Google Gemini 2.0 API
- **绘画功能**：Canvas API
- **UI组件**：自定义React组件
- **样式**：TailwindCSS

## 项目结构

```
/
├── components/        # React组件
├── pages/             # Next.js页面
├── utils/             # 工具函数
├── public/            # 静态资源
└── styles/            # 样式文件
```

## 注意事项

1. Gemini API模式需要有效的API密钥才能使用
2. 当前系统API密钥状态会在页面底部显示
3. 所有绘画数据保存在浏览器本地存储中
4. 分享功能通过URL参数传递绘画数据 